{"paragraphs":[{"text":"import sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection \nimport org.apache.spark.sql.functions._\n\n\ndef fileDownloader(urlOfFileToDownload: String, fileName: String) = {\n    val url = new URL(urlOfFileToDownload)\n    val connection = url.openConnection().asInstanceOf[HttpURLConnection]\n    connection.setConnectTimeout(5000)\n    connection.setReadTimeout(5000)\n    connection.connect()\n\n    if (connection.getResponseCode >= 400)\n        println(\"error\")\n    else\n        url #> new File(fileName) !!\n}","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection\nimport org.apache.spark.sql.functions._\nwarning: there was one feature warning; re-run with -feature for details\nfileDownloader: (urlOfFileToDownload: String, fileName: String)Any\n"}]},"apps":[],"jobName":"paragraph_1548333406580_-986852537","id":"20190115-143815_1080765645","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3070"},{"text":"fileDownloader(\"http://data.gdeltproject.org/gdeltv2/masterfilelist.txt\", \"/tmp/zeppelin-tmp/masterfilelist.txt\") // save the list file to the Spark Master","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res2: Any = \"\"\n"}]},"apps":[],"jobName":"paragraph_1548333406588_-989930528","id":"20190115-143836_703936378","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3071"},{"text":"%sh\nls -lrth /tmp/zeppelin-tmp","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"total 42M\n-rw-r--r-- 1 root root 42M Jan 15 14:39 masterfilelist.txt\n"}]},"apps":[],"jobName":"paragraph_1548333406590_-989161031","id":"20190115-143904_2053076975","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3072"},{"text":"import com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\n    \nval AWS_ID = \"X\"\nval AWS_KEY = \"X\"\nval awsClient = new AmazonS3Client(new BasicAWSCredentials(AWS_ID, AWS_KEY))\nval BUCKET = \"gdelt-raw\"\n\nsc.hadoopConfiguration.set(\"fs.s3a.access.key\", AWS_ID) // mettre votre ID du fichier credentials.csv\nsc.hadoopConfiguration.set(\"fs.s3a.secret.key\", AWS_KEY) // mettre votre secret du fichier credentials.csv\n\nawsClient.putObject(BUCKET, \"masterfilelist.txt\", new File( \"/tmp/zeppelin-tmp/masterfilelist.txt\") )\n","dateUpdated":"2019-01-24T12:37:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548333406591_-989545779","id":"20190115-143926_1241766139","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3073"},{"text":"import org.apache.spark.sql.SQLContext\n\nval sqlContext = new SQLContext(sc)\nval filesDF = sqlContext.read.\n                    option(\"delimiter\",\" \").\n                    option(\"infer_schema\",\"true\").\n                    csv(s\"s3a://$BUCKET/masterfilelist.txt\").\n                    withColumnRenamed(\"_c0\",\"size\").\n                    withColumnRenamed(\"_c1\",\"hash\").\n                    withColumnRenamed(\"_c2\",\"url\").\n                    cache\nval data_2018_df = filesDF.filter(col(\"url\").contains(\"/2018\")).cache","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.SQLContext\nwarning: there was one deprecation warning; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@67f589e1\nfilesDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\ndata_2018_df: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1548333406591_-989545779","id":"20190115-144403_1808612672","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3074"},{"text":"data_2018_df.count","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res16: Long = 102144\n"}]},"apps":[],"jobName":"paragraph_1548333406597_-907209515","id":"20190115-144637_1763504372","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3075"},{"text":"data_2018_df.show(false)","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------------------+--------------------------------------------------------------------+\n|size   |hash                            |url                                                                 |\n+-------+--------------------------------+--------------------------------------------------------------------+\n|137245 |7af27516949540f4337694cc0274af84|http://data.gdeltproject.org/gdeltv2/20180101000000.export.CSV.zip  |\n|108185 |4b7b5c44784d9e8ae1c18aa94d3df2af|http://data.gdeltproject.org/gdeltv2/20180101000000.mentions.CSV.zip|\n|5000723|a6c15cd46928fbbadf3017c792d5c08c|http://data.gdeltproject.org/gdeltv2/20180101000000.gkg.csv.zip     |\n|91437  |dbd933f041dedf095adc9c71cb6df58e|http://data.gdeltproject.org/gdeltv2/20180101001500.export.CSV.zip  |\n|104326 |b4b56970b85898b6fefcd020c401ba8d|http://data.gdeltproject.org/gdeltv2/20180101001500.mentions.CSV.zip|\n|5261451|0c7d450893b3407a75a0c66645031cb7|http://data.gdeltproject.org/gdeltv2/20180101001500.gkg.csv.zip     |\n|91495  |c0ea755c477c1b86ecd06ff18813040e|http://data.gdeltproject.org/gdeltv2/20180101003000.export.CSV.zip  |\n|115240 |018c82f2eed4f4416bc575425ea9e1e2|http://data.gdeltproject.org/gdeltv2/20180101003000.mentions.CSV.zip|\n|5956175|05933d1a796ba286339cbd72ecf7a1f9|http://data.gdeltproject.org/gdeltv2/20180101003000.gkg.csv.zip     |\n|92832  |1ffa45a1390023e584dbed23ba54253d|http://data.gdeltproject.org/gdeltv2/20180101004500.export.CSV.zip  |\n|121388 |898a667bc723e9d08382fa71bf1ba3eb|http://data.gdeltproject.org/gdeltv2/20180101004500.mentions.CSV.zip|\n|6408926|e58fb55a3226da5dbfc506c0594d2496|http://data.gdeltproject.org/gdeltv2/20180101004500.gkg.csv.zip     |\n|70221  |583cb232254db2f5514471b40e36fbcb|http://data.gdeltproject.org/gdeltv2/20180101010000.export.CSV.zip  |\n|103599 |a1f804c5d6f75cb955c43357fbb7ba0b|http://data.gdeltproject.org/gdeltv2/20180101010000.mentions.CSV.zip|\n|6162970|e50f6a01cd9ef0e4c3001f75eaf1c005|http://data.gdeltproject.org/gdeltv2/20180101010000.gkg.csv.zip     |\n|79866  |8ea89ae58786da02b92e6ff91f8417f9|http://data.gdeltproject.org/gdeltv2/20180101011500.export.CSV.zip  |\n|132697 |8eeba811f3a52eb3ace507353295f0ce|http://data.gdeltproject.org/gdeltv2/20180101011500.mentions.CSV.zip|\n|6465149|1db81656c879fc0d01207132c132bf31|http://data.gdeltproject.org/gdeltv2/20180101011500.gkg.csv.zip     |\n|73803  |ba66eff80889e4699411f3d24f52df31|http://data.gdeltproject.org/gdeltv2/20180101013000.export.CSV.zip  |\n|109040 |1497ccf95f044ece87c6b7e2177d9abc|http://data.gdeltproject.org/gdeltv2/20180101013000.mentions.CSV.zip|\n+-------+--------------------------------+--------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1548333406600_-908363762","id":"20190115-212646_1496850849","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3076"},{"text":"data_2018_df.select(sum(\"size\") / 1024 / 1024 ).show","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------------+\n|((sum(size) / 1024) / 1024)|\n+---------------------------+\n|          308469.6913661957|\n+---------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1548333406601_-908748510","id":"20190115-144652_1245436894","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3077"},{"text":"object AwsClient{\n    val s3 = new AmazonS3Client(new BasicAWSCredentials(AWS_ID, AWS_KEY))\n}\n\n\ndata_2018_df.select(\"url\").repartition(100).foreach( r=> {\n            val URL = r.getAs[String](0)\n            val fileName = r.getAs[String](0).split(\"/\").last\n            val dir = \"/tmp/zeppelin-tmp/2018/\"\n            val localFileName = dir + fileName\n            fileDownloader(URL,  localFileName)\n            val localFile = new File(localFileName)\n            AwsClient.s3.putObject(BUCKET, \"2018/\" + fileName, localFile )\n            localFile.delete()\n            println(\"$filename done.\")\n            \n})","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"defined object AwsClient\norg.apache.spark.SparkException: Job aborted due to stage failure: Task 79 in stage 18.0 failed 1 times, most recent failure: Lost task 79.0 in stage 18.0 (TID 130, localhost, executor driver): java.net.SocketTimeoutException: Read timed out\n\tat java.net.SocketInputStream.socketRead0(Native Method)\n\tat java.net.SocketInputStream.socketRead(SocketInputStream.java:116)\n\tat java.net.SocketInputStream.read(SocketInputStream.java:171)\n\tat java.net.SocketInputStream.read(SocketInputStream.java:141)\n\tat java.io.BufferedInputStream.fill(BufferedInputStream.java:246)\n\tat java.io.BufferedInputStream.read1(BufferedInputStream.java:286)\n\tat java.io.BufferedInputStream.read(BufferedInputStream.java:345)\n\tat sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:735)\n\tat sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:678)\n\tat sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1569)\n\tat sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1474)\n\tat java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:480)\n\tat fileDownloader(<console>:45)\n\tat $anonfun$1.apply(<console>:67)\n\tat $anonfun$1.apply(<console>:62)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:893)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1336)\n\tat org.apache.spark.rdd.RDD$$anonfun$foreach$1$$anonfun$apply$28.apply(RDD.scala:918)\n\tat org.apache.spark.rdd.RDD$$anonfun$foreach$1$$anonfun$apply$28.apply(RDD.scala:918)\n\tat org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:2062)\n\tat org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:2062)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:108)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:335)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:748)\n\nDriver stacktrace:\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1499)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1487)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1486)\n  at scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n  at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1486)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:814)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:814)\n  at scala.Option.foreach(Option.scala:257)\n  at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:814)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1714)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1669)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1658)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:630)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2022)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2043)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2062)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2087)\n  at org.apache.spark.rdd.RDD$$anonfun$foreach$1.apply(RDD.scala:918)\n  at org.apache.spark.rdd.RDD$$anonfun$foreach$1.apply(RDD.scala:916)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n  at org.apache.spark.rdd.RDD.foreach(RDD.scala:916)\n  at org.apache.spark.sql.Dataset$$anonfun$foreach$1.apply$mcV$sp(Dataset.scala:2325)\n  at org.apache.spark.sql.Dataset$$anonfun$foreach$1.apply(Dataset.scala:2325)\n  at org.apache.spark.sql.Dataset$$anonfun$foreach$1.apply(Dataset.scala:2325)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:65)\n  at org.apache.spark.sql.Dataset.withNewExecutionId(Dataset.scala:2823)\n  at org.apache.spark.sql.Dataset.foreach(Dataset.scala:2324)\n  ... 50 elided\nCaused by: java.net.SocketTimeoutException: Read timed out\n  at java.net.SocketInputStream.socketRead0(Native Method)\n  at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)\n  at java.net.SocketInputStream.read(SocketInputStream.java:171)\n  at java.net.SocketInputStream.read(SocketInputStream.java:141)\n  at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)\n  at java.io.BufferedInputStream.read1(BufferedInputStream.java:286)\n  at java.io.BufferedInputStream.read(BufferedInputStream.java:345)\n  at sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:735)\n  at sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:678)\n  at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1569)\n  at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1474)\n  at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:480)\n  at fileDownloader(<console>:45)\n  at $anonfun$1.apply(<console>:67)\n  at $anonfun$1.apply(<console>:62)\n  at scala.collection.Iterator$class.foreach(Iterator.scala:893)\n  at scala.collection.AbstractIterator.foreach(Iterator.scala:1336)\n  at org.apache.spark.rdd.RDD$$anonfun$foreach$1$$anonfun$apply$28.apply(RDD.scala:918)\n  at org.apache.spark.rdd.RDD$$anonfun$foreach$1$$anonfun$apply$28.apply(RDD.scala:918)\n  at org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:2062)\n  at org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:2062)\n  at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n  at org.apache.spark.scheduler.Task.run(Task.scala:108)\n  at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:335)\n  ... 3 more\n"}]},"apps":[],"jobName":"paragraph_1548333406604_-909902757","id":"20190115-144702_18832828","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3078"},{"text":"import scala.collection.JavaConverters._\nimport collection.mutable._","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.collection.JavaConverters._\nimport collection.mutable._\nobjects: scala.collection.mutable.Buffer[com.amazonaws.services.s3.model.S3ObjectSummary] = Buffer(com.amazonaws.services.s3.model.S3ObjectSummary@5c635fbe, com.amazonaws.services.s3.model.S3ObjectSummary@3f8b4585, com.amazonaws.services.s3.model.S3ObjectSummary@29494e44, com.amazonaws.services.s3.model.S3ObjectSummary@5e7fbd75, com.amazonaws.services.s3.model.S3ObjectSummary@182787ab, com.amazonaws.services.s3.model.S3ObjectSummary@7d655e47, com.amazonaws.services.s3.model.S3ObjectSummary@1ebd04c1, com.amazonaws.services.s3.model.S3ObjectSummary@3d8a9676, com.amazonaws.services.s3.model.S3ObjectSummary@193454b3, com.amazonaws.services.s3.model.S3ObjectSummary@4ef4b6b4, com.amazonaws.services.s3.model.S3ObjectSummary@381938a7, com.amazonaws.services.s3.model.S3ObjectSummary@514930f4, co...res61: Int = 1000\n"}]},"apps":[],"jobName":"paragraph_1548333406605_-910287506","id":"20190115-145455_772434312","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3079"},{"text":"var listing = awsClient.listObjects(BUCKET);\nval summaries = listing.getObjectSummaries();\n\nwhile (listing.isTruncated()) {\n   listing = awsClient.listNextBatchOfObjects(listing);\n   summaries.addAll(listing.getObjectSummaries());\n}","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"listing: com.amazonaws.services.s3.model.ObjectListing = com.amazonaws.services.s3.model.ObjectListing@1296812c\nsummaries: java.util.List[com.amazonaws.services.s3.model.S3ObjectSummary] = [com.amazonaws.services.s3.model.S3ObjectSummary@9edc9a4, com.amazonaws.services.s3.model.S3ObjectSummary@2f2eff97, com.amazonaws.services.s3.model.S3ObjectSummary@11a4f991, com.amazonaws.services.s3.model.S3ObjectSummary@8445567, com.amazonaws.services.s3.model.S3ObjectSummary@6f831d22, com.amazonaws.services.s3.model.S3ObjectSummary@37898502, com.amazonaws.services.s3.model.S3ObjectSummary@1578a13, com.amazonaws.services.s3.model.S3ObjectSummary@2b920833, com.amazonaws.services.s3.model.S3ObjectSummary@5c8f6a6e, com.amazonaws.services.s3.model.S3ObjectSummary@27d55568, com.amazonaws.services.s3.model.S3ObjectSummary@1a6f5493, com.amazonaws.services.s3.model.S3ObjectSummary@2107147d, com.amazonaws.services.s3...."}]},"apps":[],"jobName":"paragraph_1548333406606_-909133259","id":"20190115-210736_1044552830","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3080"},{"text":"summaries.size()","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res108: Int = 83420\n"}]},"apps":[],"jobName":"paragraph_1548333406607_-909518008","id":"20190115-215739_980533051","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3081"},{"text":"val uploaded = summaries.asScala.map( o => o.getKey().split(\"/\").tail.headOption).filter(u  => u != null).flatten.toSet","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"uploaded: scala.collection.immutable.Set[String] = Set(20180312011500.gkg.csv.zip, 20180627204500.export.CSV.zip, 20181218221500.export.CSV.zip, 20180813034500.mentions.CSV.zip, 20180820060000.mentions.CSV.zip, 20181018191500.mentions.CSV.zip, 20180809151500.gkg.csv.zip, 20181231193000.export.CSV.zip, 20180713094500.export.CSV.zip, 20180429020000.mentions.CSV.zip, 20181221191500.gkg.csv.zip, 20180826021500.export.CSV.zip, 20180607233000.export.CSV.zip, 20180117181500.export.CSV.zip, 20180109201500.gkg.csv.zip, 20181008181500.mentions.CSV.zip, 20180919163000.mentions.CSV.zip, 20180327020000.export.CSV.zip, 20180618171500.gkg.csv.zip, 20180927053000.gkg.csv.zip, 20180205064500.export.CSV.zip, 20180820070000.gkg.csv.zip, 20180605004500.export.CSV.zip, 20180424114500.gkg.csv.zip, 2018111513..."}]},"apps":[],"jobName":"paragraph_1548333406607_-909518008","id":"20190115-212335_333242333","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3082"},{"text":"data_2018_df.collect().toList.par.map(r => r.getAs[String](2)).filterNot(u => uploaded.contains(u.split(\"/\").last)).foreach( u => {\n            val URL = u\n            val fileName = u.split(\"/\").last\n            val dir = \"/tmp/zeppelin-tmp/2018/\"\n            val localFileName = dir + fileName\n            fileDownloader(URL,  localFileName)\n            val localFile = new File(localFileName)\n            AwsClient.s3.putObject(BUCKET, \"2018/\" + fileName, localFile )\n            localFile.delete()\n            println(s\"$fileName done.\")\n})","dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548333406607_-909518008","id":"20190115-212404_1922705872","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3083"},{"dateUpdated":"2019-01-24T12:36:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548333406608_-899129788","id":"20190115-213501_1646075732","dateCreated":"2019-01-24T12:36:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3084"}],"name":"save_raw_gdelt_2s3","id":"2E2NAMTDS","angularObjects":{"2E2FF8FTV:shared_process":[],"2E1N6NBJ3:shared_process":[],"2E236X4UW:shared_process":[],"2E29UANK6:shared_process":[],"2E3855KMP:shared_process":[],"2E1B4KM8V:shared_process":[],"2E2VR3QHJ:shared_process":[],"2E2HG6YK4:shared_process":[],"2DZFY5Z29:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}